<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free HIV Rapid Tests • Abundant Science</title>

    <!-- Load Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />

    <!-- Load your stylesheet -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Load Supabase client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.min.js"></script>
</head>

<body>

    <!-- Navigation Bar -->
    <nav>
        <div class="logo-container">
            <a href="index.html"
                style="display: flex; align-items: center; gap: 0.5rem; text-decoration: none; color: inherit;">
                <img src="logo-nobackground.jpg" alt="Abundant Science logo">
                <strong>Abundant Science</strong>
            </a>
        </div>
        <div class="nav-links">
            <a href="about.html">Our Mission</a>
        </div>
    </nav>

    <!-- Hero / Form Section -->
    <div class="container">
        <img src="cover-hiv-image.jpg" alt="Free HIV Test"
            style="width: 50%; max-width: 600px; margin: 1rem 0; border-radius: 8px;" />

        <p style="color: #666">

        <form id="waitlist-form">

            <input type="email" id="email" placeholder="Email" required />
            <!-- Check boxes for campaign selection, will be inserted into campaign filed in waitlist table -->
            <div style="margin: 1rem 0; text-align: left; display: flex; flex-direction: column; align-items:
                flex-start;">
                <label>
                    <input type="checkbox" id="discreet-checkbox" /> I’m discreet – (Your email won’t say HIV in it)
                </label>

                <label><input type="checkbox" class="campaign-checkbox" value="hiv-prep-rapid-test" /> I want rapid
                    testing for HIV PrEP</label>
                <label>
                    <input type="checkbox" class="campaign-checkbox" value="rapid-test-your-drugs" data-extra="pnp" />
                    I PnP and want to test my drugs
                </label>

            </div>

            <button type="submit">Get Your Guide</button>
        </form>

        <div id="message"></div>
    </div>


    <section class="biomarker-section">
        <p style="text-align: left;">
            You deserve to know.

            11% of Canadians with an HIV infection — about 7,000 people — don’t know their status. Could you be one of
            them?

            Free Health Canada-approved, made-in-Canada HIV self rapid tests are available now, mailed to you or picked
            up in your community. 99% accurate. Results in less than 10 minutes.

            At Abundant Science, we’re building rapid testing as a category in Canada. Sign up below, and we’ll email
            you a simple guide to getting your free rapid tests.
            <br>
            <br>

        </p>


        <section class=" resources-section"
            style="padding: 2rem; background-color: #f9f9f9; border-top: 1px solid #ddd;">
            <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Abundant Resources • HIV Rapid Testing</h3>
            <ul style="list-style: none; text-align: left; padding: 0; line-height: 1.6;">
                <li>
                    <strong> <a href="https://hivtestingontario.ca/self-testing/" target="_blank">HIV self-testing in
                            Canada (HIVTestingOntario.ca)
                        </a> </strong> - Comprehensive overview of self-testing options and where to access
                    them in Canada, including Ontario-only programs.
                </li>

                <li>
                    <strong>
                        <a href="https://www.catie.ca/catie-statement-on-the-hiv-self-test-as-a-highly-effective-tool-for-increasing-uptake-of-testing-in"
                            target="_blank">HIV Self-Testing Evidence Review (CATIE.ca) </a>
                    </strong> – Self-testing can help to overcome barriers people face when accessing testing: stigma,
                    privacy fears, lack of local options.
                </li>

                <li>
                    <strong>
                        <a href="https://www.catie.ca/the-epidemiology-of-hiv-in-canada" target="_blank">Epidemiology of
                            HIV in Canada (CATIE.ca)
                        </a> </strong> – Where, who, and how people are acquiring HIV infections in Canada. Focuses on
                    post-pandemic rise in HIV diagnoses.


                </li>

            </ul>
        </section>

        <footer class="site-footer">
            <p>&copy; 2025 Abundant Science. All rights reserved.</p>
            <p><a href="mailto:contact@abundant.science">Contact Us</a></p>
        </footer>

</body>



<!-- Supabase Script -->
<script>
    window.addEventListener("DOMContentLoaded", function () {
        const SUPABASE_URL = "https://jicytgdlbevccejowlnf.supabase.co";
        const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImppY3l0Z2RsYmV2Y2Nlam93bG5mIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUzNDQzNTYsImV4cCI6MjA2MDkyMDM1Nn0.DRfZefUPOLjhdxYudhvQKGePr6ex-Xf3JBkedbF7_OY";

        const client = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        document.getElementById("waitlist-form").addEventListener("submit", async function (e) {
            e.preventDefault();

            const email = document.getElementById("email").value.trim();
            const msg = document.getElementById("message");
            const checkboxes = document.querySelectorAll(".campaign-checkbox:checked");
            const discreet = document.getElementById("discreet-checkbox").checked; // true or false

            let campaign = [];
            checkboxes.forEach(cb => {
                campaign.push(cb.value);
                if (cb.dataset.extra) {
                    campaign.push(cb.dataset.extra);
                }
            });


            msg.textContent = "";
            msg.className = "";

            if (!email || !email.includes("@")) {
                msg.textContent = "Please enter a valid email.";
                msg.className = "error";
                return;
            }

            try {
                const { data, error } = await client
                    .from("waitlist")
                    .insert([{
                        email,
                        source_page: "HIV Test",
                        campaign,
                        discreet
                    }]);

                if (error) {
                    msg.textContent = "❌ Error: " + error.message;
                    msg.className = "error";
                } else {
                    msg.textContent = "✅ You're on the list!";
                    msg.className = "success";
                    document.getElementById("waitlist-form").reset();
                }
            } catch (err) {
                console.error("❗ Unexpected error:", err);
                msg.textContent = "❌ Something went wrong.";
                msg.className = "error";
            }
        });

    });
</script>


</html>
